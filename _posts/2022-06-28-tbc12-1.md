---
layout: single
classes: wide
categories: ["C", "홍정모", "따배씨", "홍정모의 따라하며 배우는 C언어"]
title:  "[홍정모의 따라하며 배우는 C언어] 12.1 메모리 레이아웃 훑어보기"
author_profile: true
---

## 11. Storage Classes, Linkage and Memory Management

### 12.1 메모리 레이아웃 훑어보기

#### 12.1.1 프로그램이 시작될 때

1. 프로그램 코드(Text Segment)
   1. 프로그램을 실행시키려면 프로그램 자체가 메모리에 올라가야 한다.
   2. 또한, 한번 작성한 프로그램의 내용이 변경되면 안된다.
   3. 따라서 프로그램 코드는 읽기 전용이며, 이를 변경하려고 하면 OS가 막는다.
   4. 예) 문자열
   5. Function Pointer: 함수 자체의 주소, 함수도 메모리에 저장되어 있기 때문에 함수의 주소를 가져올 수 있다.
   6. 한번 프로그램이 메모리에 올라오면, 프로그램이 끝날 때까지 메모리에 계속 남아있어야 한다.

#### 12.1.2 프로그램 전체에서 계속 사용되는 변수들

1. 초기화된 전역/정적 변수들
2. 초기화되지 않은 전역/정적 변수들
3. 전역/정적 변수들은 프로그램 코드와 마찬가지로 프로그램이 끝날때까지 계속 메모리에 남아 있는다.

#### 12.1.3 프로그램 일부에서 큰 메모리가 필요한 경우

1. 지역변수
   1. 특정 영역에서만 사용되는 변수
   2. 스택(Stack)이라는 메모리 공간을 사용
   3. 스택을 필요할 때 늘어났다가 불필요할 때는 줄어드는 특성이 있음 --> 효율적으로 메모리를 사용할 수 있음
   4. 스택의 단점도 존재 --> 메모리 동적할당을 사용하는 이유임
   5. 지역변수로 선언된 코드는 필요할 때만 스택에 들어가고 이후에는 그 메모리를 차지하지 않는다.(메모리를 다른 곳에서 사용할 수 있게 OS에 권한을 넘겨준다.)
   6. 메모리 공간을 얼마나 사용할지는 컴파일할 때 결정됨

#### 12.1.4 필요한 메모리의 크기를 미리 알 수 없을 경우

1. 대부분의 프로그램은 필요한 메모리의 크기를 미리 알 수 없음 ex) 게임에 접속할 사용자의 수
2. 따라서 메모리 동적할당이 필요
3. 메모리 동적할당은 힙(Heap) 영역을 사용
4. 스택과 힙이 메모리 주소 충돌이 일어나지 않는 이유는 OS가 가상 주소 공간을 사용하도록 하기 때문이다.
5. 단점: 운영체제로부터 동적할당에 필요한 만큼의 메모리 주소를 받아와야 하기 때문에 속도가 느림
6. C나 고전적 C++은 힙 메모리를 관리해야할 필요가 있음(프로그래머가 필요한 만큼 할당받고, 사용한 뒤에는 메모리를 반납해야 한다.)
